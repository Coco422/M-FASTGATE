# M-FastGate Phase 2.1 开发计划

## 目标
完善Phase 2的Web管理界面，确保所有现有功能都能正常访问和使用。**不添加新功能，专注于完成现有功能的实现。**

## 当前状态分析
- ✅ **基础架构已完成**: 认证、路由、静态文件服务
- ✅ **首页Dashboard已完成**: 能正常访问并显示统计信息
- ❌ **功能页面缺失**: 缺少3个关键页面的模板文件
- ❌ **API对接不完整**: 前端JavaScript与后端API的集成需要完善

## 开发任务清单

### 1. 查看已有Key，管理Key 功能
**目标**: 实现 `/admin/ui/keys` 页面

#### 需要完成:
- [ ] 创建 `app/templates/api_keys.html` 模板
  - 显示所有API Key列表 (表格形式)
  - 每个Key显示: 用户名、创建时间、过期时间、状态、使用次数
  - 搜索和过滤功能
  - 删除/禁用Key功能
  - 创建新Key功能
- [ ] 创建 `app/static/js/api_keys.js` 
  - API Key管理逻辑
  - 与后端API `/admin/api_keys/` 对接
  - 表格分页和排序
- [ ] 验证后端API `/admin/api_keys/` 路由完整性

### 2. 查看详细调用日志功能  
**目标**: 实现 `/admin/ui/logs` 页面

#### 需要完成:
- [ ] 创建 `app/templates/audit_logs.html` 模板
  - 显示所有请求日志列表
  - 字段: 时间、API Key、请求方法、状态码、响应时间、数据大小、请求类型
  - 时间范围筛选器
  - API Key筛选器
  - 状态码筛选器
  - 实时日志功能
- [ ] 创建 `app/static/js/audit_logs.js`
  - 日志查询和筛选逻辑
  - 与后端API `/admin/audit_logs/` 对接
  - 自动刷新功能
- [ ] 验证后端API `/admin/audit_logs/` 路由完整性

### 3. 根据Key查看调用报告功能
**目标**: 实现 `/admin/ui/stats` 页面

#### 需要完成:
- [ ] 创建 `app/templates/statistics.html` 模板  
  - 按API Key分组的统计信息
  - 调用次数、成功率、平均响应时间图表
  - 时间维度统计 (今日/本周/本月)
  - 各Key的使用排行榜
- [ ] 创建 `app/static/js/statistics.js`
  - 统计图表渲染 (Chart.js)
  - 与后端API `/admin/statistics/` 对接
  - 报告导出功能
- [ ] 验证后端API `/admin/statistics/` 路由完整性

### 4. 前后端集成完善
- [ ] 检查所有现有后端API端点是否正常工作
- [ ] 完善错误处理和用户提示
- [ ] 统一API响应格式
- [ ] 添加加载状态和空数据状态

## 开发顺序
1. **API Keys管理页面** (优先级最高)
2. **审计日志页面** 
3. **统计报告页面**
4. **整体测试和优化**

## 验收标准
1. 所有Dashboard上的链接都能正常跳转
2. 所有功能页面都能正常显示数据
3. 所有操作都有适当的用户反馈
4. 页面响应速度良好，加载状态清晰
5. 错误处理完善，用户体验良好

## 预估完成时间
- 总计: 4-6小时
- API Keys页面: 2小时
- 日志页面: 1.5小时  
- 统计页面: 1.5小时
- 集成测试: 1小时

---

**注意**: 本阶段严格遵循"完成现有功能"的原则，不添加任何新功能。重点是让用户能够流畅使用Dashboard上已有的功能入口。 