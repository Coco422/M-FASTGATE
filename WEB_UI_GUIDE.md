# M-FastGate Web管理界面使用指南

## 概述

M-FastGate Web管理界面是一个现代化的实时监控和管理面板，提供直观的API网关管理功能。基于Bootstrap 5设计，支持桌面端和移动端访问。

## 快速访问

### 启动服务

```bash
# 启动M-FastGate服务
python -m uvicorn app.main:app --host 0.0.0.0 --port 8514 --reload
```

### 访问Web界面

```
http://你的服务器IP:8514/admin/ui/?token=你的管理员令牌
```

**默认管理员令牌**: `admin_secret_token_dev` (开发环境)

## 界面功能详解

### 🏠 主仪表板页面

访问地址: `/admin/ui/`

#### 📊 统计卡片
- **API Keys**: 显示当前系统中的API Key总数量
- **请求总数**: 显示累计请求数量和今日统计
- **平均响应时间**: 系统平均响应时间（毫秒）
- **成功率**: 计算成功请求比例和系统健康状态

#### 📈 请求趋势图表
- 显示最近24小时的请求趋势
- 绿线：正常请求数量
- 红线：错误请求数量
- 使用Chart.js实现，支持交互式查看

#### 🎯 快速操作面板
- **创建API Key**: 一键弹出创建窗口
- **查看最新日志**: 跳转到日志页面
- **刷新系统状态**: 手动刷新统计数据
- **查看API文档**: 新窗口打开API文档

#### ℹ️ 系统信息
- **服务状态**: 实时显示服务运行状态
- **网关地址**: 显示当前网关访问地址
- **API端点**: 统一端点路径
- **管理Token**: 令牌配置状态

#### 📋 最近请求记录
- 显示最新10条请求记录
- 包含时间、API Key、方法、状态码、响应时间等信息
- 区分流式和普通请求类型
- 支持数据大小格式化显示

### 🔑 API Key管理

访问地址: `/admin/ui/keys` (架构已完成，待扩展)

功能规划：
- Key列表查看和搜索
- 批量操作管理
- 使用统计详情
- 权限配置编辑

### 📋 审计日志查看

访问地址: `/admin/ui/logs` (架构已完成，待扩展)

功能规划：
- 日志搜索和过滤
- 实时日志流
- 详细请求分析
- 导出功能

### 📊 统计信息页面

访问地址: `/admin/ui/stats` (架构已完成，待扩展)

功能规划：
- 详细统计图表
- 性能指标分析
- 用户使用报告
- 趋势分析

## 主要功能操作

### 创建API Key

1. 在主仪表板点击 **"创建API Key"** 按钮
2. 填写表单：
   - **用户标识**: 输入用户标识（如: user1, user2）
   - **有效期**: 设置Key有效期（天数，默认30天）
   - **权限**: 默认包含聊天完成权限
3. 点击 **"创建"** 按钮
4. 系统显示创建成功信息和完整的API Key
5. API Key会自动添加到系统中

### 监控系统状态

#### 自动刷新
- 系统每30秒自动刷新数据
- 无需手动操作，保持实时性

#### 手动刷新
- 点击 **"刷新系统状态"** 按钮
- 立即更新所有统计数据

#### 状态指示器
- **运行中** (绿色): 系统正常运行
- **注意** (黄色): 成功率在80-95%之间
- **异常** (红色): 成功率低于80%

### 查看请求记录

#### 最近记录表格
- 显示最新10条请求记录
- 包含完整的请求信息
- 实时更新，自动刷新

#### 记录信息解读
- **时间**: 请求发生的具体时间
- **API Key**: 使用的Key（显示前16位）
- **方法**: HTTP请求方法（POST）
- **状态**: HTTP状态码（彩色徽章）
- **响应时间**: 请求处理耗时
- **数据大小**: 请求和响应的数据量
- **类型**: 流式或普通请求

## 界面特性

### 🎨 设计特点
- **现代化设计**: Bootstrap 5 + 自定义主题
- **渐变色卡片**: 美观的统计卡片设计
- **响应式布局**: 支持桌面和移动端
- **图标系统**: Font Awesome 6.0图标库

### ⚡ 交互体验
- **实时更新**: 30秒自动刷新机制
- **加载状态**: 完善的加载状态管理
- **消息提示**: 智能的操作反馈系统
- **错误处理**: 友好的错误提示

### 📱 移动端适配
- 响应式设计，自动适配屏幕尺寸
- 移动端优化的按钮和表格
- 触摸友好的交互元素

## 技术架构

### 前端技术栈
```
- UI框架: Bootstrap 5.1.3
- 图标库: Font Awesome 6.0.0
- 图表库: Chart.js
- 模板引擎: Jinja2
- JavaScript: ES6 + 原生DOM API
```

### 文件结构
```
app/
├── api/ui.py              # Web UI路由
├── templates/
│   ├── base.html          # 基础模板
│   └── dashboard.html     # 仪表板页面
├── static/
│   ├── css/admin.css      # 自定义样式
│   └── js/
│       ├── common.js      # 公共工具函数
│       └── dashboard.js   # 仪表板逻辑
```

### API集成
- 使用Fetch API进行数据请求
- 封装的ApiClient类统一管理
- 支持并行请求和错误处理
- 自动令牌管理

## 使用技巧

### 🔧 高效使用建议

1. **书签收藏**: 将带token的URL收藏，避免重复输入
2. **多标签页**: 可同时打开多个功能页面
3. **定期检查**: 关注系统状态变化和异常提醒
4. **快速创建**: 使用仪表板的快速创建功能

### 🚨 注意事项

1. **令牌安全**: 管理员令牌不要在公共场所展示
2. **数据刷新**: 重要操作后可手动刷新确认结果
3. **浏览器兼容**: 推荐使用Chrome、Firefox、Edge等现代浏览器
4. **网络环境**: 确保服务器网络连接稳定

### 📊 监控最佳实践

1. **定期检查**: 每日查看系统状态和成功率
2. **异常处理**: 发现异常状态及时调查原因
3. **趋势分析**: 观察请求量变化趋势
4. **用户管理**: 定期清理过期或未使用的API Key

## 故障排除

### 常见问题

#### 1. 无法访问Web界面
- 检查服务是否正常启动
- 确认端口8514是否开放
- 验证管理员令牌是否正确

#### 2. 数据不更新
- 检查网络连接
- 确认后端API服务正常
- 尝试手动刷新页面

#### 3. 创建API Key失败
- 检查管理员权限
- 确认数据库连接正常
- 查看后端错误日志

#### 4. 图表不显示
- 确保网络能访问CDN资源
- 检查浏览器控制台错误信息
- 尝试刷新页面

### 调试信息

在浏览器控制台可以查看：
- API请求和响应详情
- JavaScript错误信息
- 网络连接状态
- 数据加载过程

## 未来扩展

### 计划功能

1. **API Key管理页面**: 完整的Key管理功能
2. **详细日志页面**: 高级搜索和过滤
3. **统计分析页面**: 更丰富的图表和报告
4. **用户权限管理**: 多级权限控制
5. **系统配置页面**: 在线配置修改

### 自定义开发

支持的自定义选项：
- 主题色彩配置
- 自定义统计指标
- 扩展图表类型
- 自定义组件开发

## 总结

M-FastGate Web管理界面提供了完整的API网关管理功能，具有现代化的设计和良好的用户体验。通过实时监控、快速操作和直观展示，帮助管理员高效管理API网关系统。

更多技术细节请参考：
- [README.md](./README.md) - 项目总体介绍
- [develop-phase2.md](./develop-phase2.md) - Phase 2开发日志
- API文档: http://localhost:8514/docs 